// Generated by CoffeeScript 1.9.3
(function() {
  var app;

  app = angular.module("kodiRemote.tvshows.controllers", []);

  app.controller("TvShowsController", [
    "$scope", "$controller", "Topbar", "TvShows", function($scope, $controller, Topbar, TvShows) {
      Topbar.reset();
      Topbar.addTitle("TV Shows");
      $scope.listService = TvShows;
      $scope.pushItemsOntoList = function(data) {
        var i, len, ref, tvShow;
        ref = data.tvshows;
        for (i = 0, len = ref.length; i < len; i++) {
          tvShow = ref[i];
          $scope.list.push(tvShow);
        }
        return Topbar.addTitle("TV Shows (" + data.limits.total + ")");
      };
      $controller("PaginatedController", {
        $scope: $scope
      });
      $scope.setItemsOnList = function(data) {
        return $scope.list = data.tvshows;
      };
      $scope.emptyList = function() {
        return $scope.list = [];
      };
      $controller("SearchController", {
        $scope: $scope
      });
      return $scope.visitSeasons = function(tvShowId) {
        return $scope.visit("/tvshows/" + tvShowId + "/seasons");
      };
    }
  ]);

  app.controller("TvShowSeasonsController", [
    "$scope", "$routeParams", "Topbar", "Remote", function($scope, $routeParams, Topbar, Remote) {
      $scope.tvShowId = parseInt($routeParams.id);
      $scope.visitEpisodes = function(tvShowId, seasonId) {
        return $scope.visit("/tvshows/" + tvShowId + "/seasons/" + seasonId + "/episodes");
      };
      Remote.videoLibrary.tvShows.show($scope.tvShowId).then(function(data) {
        $scope.tvShowDetails = data.tvshowdetails;
        Topbar.reset();
        return Topbar.addLink("/tvshows", data.tvshowdetails.label);
      });
      $scope.loading = true;
      $scope.seasons = [];
      return Remote.videoLibrary.tvShows.seasons.index($scope.tvShowId).then(function(data) {
        $scope.loading = false;
        $scope.seasons = data.seasons;
      });
    }
  ]);

  app.controller("TvShowSeasonEpisodesController", [
    "$scope", "$routeParams", "Topbar", "Remote", function($scope, $routeParams, Topbar, Remote) {
      $scope.tvShowId = parseInt($routeParams.tvshowid);
      $scope.seasonId = parseInt($routeParams.id);
      $scope.tvShowDetails = null;
      $scope.episodes = [];
      $scope.seasonNumber = null;
      $scope.loading = true;
      Remote.videoLibrary.tvShows.show($scope.tvShowId).then(function(data) {
        return $scope.tvShowDetails = data.tvshowdetails;
      });
      Remote.videoLibrary.tvShows.seasons.index($scope.tvShowId).then(function(data) {
        var i, index, len, ref, results, season;
        ref = data.seasons;
        results = [];
        for (index = i = 0, len = ref.length; i < len; index = ++i) {
          season = ref[index];
          if (season.seasonid === $scope.seasonId) {
            $scope.seasonNumber = index + 1;
            Topbar.reset();
            results.push(Topbar.addLink("/tvshows/" + $scope.tvShowId + "/seasons", season.label));
          } else {
            results.push(void 0);
          }
        }
        return results;
      });
      return $scope.$watch("seasonNumber", function() {
        if ($scope.seasonNumber) {
          return Remote.videoLibrary.tvShows.seasons.episodes.index($scope.tvShowId, $scope.seasonNumber).then(function(data) {
            $scope.loading = false;
            $scope.episodes = data.episodes;
          });
        }
      });
    }
  ]);

}).call(this);
